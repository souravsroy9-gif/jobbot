<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JobBot Pro v2.0 - Agartala Jobs | 50+ Sources | Auto-Update</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      min-height: 100vh;
      color: white;
      padding: 12px;
    }
    .container { max-width: 900px; margin: 0 auto; }
    .header { text-align: center; padding: 15px 0; margin-bottom: 15px; }
    .logo { font-size: 36px; margin-bottom: 5px; }
    h1 { font-size: 22px; margin-bottom: 5px; background: linear-gradient(90deg, #22c55e, #3b82f6, #f97316); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .subtitle { color: #94a3b8; font-size: 13px; }
    .badge { display: inline-block; background: #22c55e; color: #000; padding: 3px 10px; border-radius: 20px; font-size: 10px; font-weight: bold; margin-top: 5px; }
    
    .stats-bar { display: flex; justify-content: center; gap: 8px; margin: 15px 0; flex-wrap: wrap; }
    .stat-item { text-align: center; padding: 8px 12px; background: #1e293b; border-radius: 10px; border: 1px solid #334155; min-width: 70px; }
    .stat-num { font-size: 18px; font-weight: bold; color: #22c55e; }
    .stat-label { font-size: 9px; color: #94a3b8; }
    
    .search-section { background: #1e293b; border-radius: 12px; padding: 12px; margin-bottom: 12px; border: 1px solid #334155; }
    .search-row { display: flex; gap: 8px; margin-bottom: 10px; flex-wrap: wrap; }
    .search-input { flex: 1; min-width: 150px; padding: 10px; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; font-size: 13px; }
    .search-btn { background: linear-gradient(135deg, #22c55e, #16a34a); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }
    .search-btn:disabled { background: #64748b; }
    
    .category-tabs { display: flex; gap: 6px; margin-bottom: 12px; overflow-x: auto; padding-bottom: 5px; }
    .tab { padding: 8px 14px; border-radius: 20px; border: 1px solid #334155; background: transparent; color: #94a3b8; font-size: 12px; cursor: pointer; white-space: nowrap; }
    .tab.active { background: #22c55e; color: #000; border-color: #22c55e; font-weight: bold; }
    .tab:hover { border-color: #22c55e; }
    
    .card { background: #1e293b; border-radius: 12px; padding: 12px; margin-bottom: 12px; border: 1px solid #334155; }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .card-title { font-size: 15px; font-weight: bold; }
    .refresh-btn { background: #22c55e; color: #000; border: none; padding: 8px 14px; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 12px; }
    .refresh-btn:disabled { background: #64748b; }
    
    .job-grid { display: grid; gap: 10px; }
    .job-card { background: #334155; border-radius: 10px; padding: 12px; border-left: 4px solid #22c55e; }
    .job-card.government { border-left-color: #f97316; }
    .job-card.bank { border-left-color: #3b82f6; }
    .job-card.private { border-left-color: #a855f7; }
    .job-card.internship { border-left-color: #ec4899; }
    .job-card.freshers { border-left-color: #14b8a6; }
    
    .job-header { display: flex; justify-content: space-between; margin-bottom: 6px; }
    .job-title { font-size: 14px; font-weight: bold; flex: 1; }
    .job-salary { color: #22c55e; font-size: 12px; font-weight: bold; text-align: right; }
    .job-company { color: #60a5fa; font-size: 12px; margin-bottom: 4px; }
    .job-details { display: flex; gap: 10px; color: #94a3b8; font-size: 11px; margin-bottom: 6px; flex-wrap: wrap; }
    .match-badge { background: #166534; color: #86efac; padding: 3px 8px; border-radius: 12px; font-size: 10px; }
    .job-type { font-size: 9px; padding: 2px 6px; border-radius: 4px; }
    .type-government { background: #f97316; color: white; }
    .type-bank { background: #3b82f6; color: white; }
    .type-private { background: #a855f7; color: white; }
    .type-internship { background: #ec4899; color: white; }
    .type-freshers { background: #14b8a6; color: white; }
    .source-badge { background: #1e40af; color: white; padding: 2px 6px; border-radius: 4px; font-size: 9px; }
    
    .btn { padding: 6px 12px; border-radius: 6px; border: none; cursor: pointer; font-size: 11px; font-weight: bold; margin-top: 8px; margin-right: 4px; text-decoration: none; display: inline-block; }
    .btn-apply { background: #22c55e; color: #000; }
    .btn-details { background: #3b82f6; color: white; }
    .btn-save { background: #f97316; color: white; }
    .btn-saved { background: #64748b; color: white; }
    
    .update-time { text-align: center; color: #64748b; font-size: 11px; margin-bottom: 10px; }
    .update-time .live { color: #22c55e; }
    
    .cv-section { background: linear-gradient(135deg, #1e40af, #7c3aed); border-radius: 12px; padding: 12px; margin-bottom: 12px; }
    .cv-title { font-size: 13px; margin-bottom: 8px; }
    .cv-input { width: 100%; padding: 8px; border-radius: 6px; border: none; background: rgba(255,255,255,0.1); color: white; margin-bottom: 6px; font-size: 12px; }
    .cv-input::placeholder { color: rgba(255,255,255,0.5); }
    .cv-status { font-size: 10px; color: #86efac; }
    
    .saved-section { display: none; }
    .saved-section.show { display: block; }
    
    .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); z-index: 1000; padding: 15px; overflow-y: auto; }
    .modal-content { background: #1e293b; border-radius: 15px; padding: 18px; max-width: 500px; margin: 20px auto; }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .close-btn { background: none; border: none; color: #94a3b8; font-size: 26px; cursor: pointer; }
    .form-group { margin-bottom: 12px; }
    .form-label { display: block; margin-bottom: 4px; color: #94a3b8; font-size: 12px; }
    .form-input { width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #334155; background: #0f172a; color: white; font-size: 13px; }
    .form-textarea { height: 180px; resize: vertical; }
    .desc-modal { color: #cbd5e1; line-height: 1.6; font-size: 13px; }
    
    .footer { text-align: center; padding: 15px; color: #64748b; font-size: 11px; }
    .footer-links { margin-top: 8px; }
    .footer-links a { color: #60a5fa; margin: 0 8px; text-decoration: none; font-size: 10px; }
    
    .spin { animation: spin 1s linear infinite; display: inline-block; }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    
    .no-jobs { text-align: center; padding: 30px; color: #94a3b8; }
    .loading { text-align: center; padding: 30px; color: #60a5fa; }
    
    .applied-tag { background: #22c55e; color: #000; padding: 2px 6px; border-radius: 4px; font-size: 9px; margin-left: 6px; }
    .tracker { background: #1e293b; border-radius: 10px; padding: 10px; margin-bottom: 12px; border: 1px solid #334155; }
    .tracker-row { display: flex; justify-content: space-around; text-align: center; }
    .tracker-item { padding: 5px; }
    .tracker-num { font-size: 18px; font-weight: bold; }
    .tracker-label { font-size: 10px; color: #94a3b8; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">ü§ñ</div>
      <h1>JobBot Pro v2.0</h1>
      <p class="subtitle">üìç Agartala, Tripura | 50+ Job Sources | Auto-Update Every Hour</p>
      <span class="badge">üÜì 100% FREE</span>
    </div>

    <div class="stats-bar">
      <div class="stat-item">
        <div class="stat-num" id="jobCount">0</div>
        <div class="stat-label">Jobs Found</div>
      </div>
      <div class="stat-item">
        <div class="stat-num" id="apiCount">4</div>
        <div class="stat-label">APIs Active</div>
      </div>
      <div class="stat-item">
        <div class="stat-num" id="updateStatus">‚ü≥</div>
        <div class="stat-label">Status</div>
      </div>
      <div class="stat-item">
        <div class="stat-num" id="savedCount">0</div>
        <div class="stat-label">Saved</div>
      </div>
    </div>

    <div class="tracker">
      <div class="tracker-row">
        <div class="tracker-item">
          <div class="tracker-num" style="color:#22c55e;" id="appliedCount">0</div>
          <div class="tracker-label">Applied</div>
        </div>
        <div class="tracker-item">
          <div class="tracker-num" style="color:#f97316;" id="savedJobsCount">0</div>
          <div class="tracker-label">Saved</div>
        </div>
        <div class="tracker-item">
          <div class="tracker-num" style="color:#3b82f6;" id="viewedCount">0</div>
          <div class="tracker-label">Viewed</div>
        </div>
      </div>
    </div>

    <p class="update-time">
      üïê Last Updated: <span id="lastUpdate">Loading...</span> (IST) | 
      <span class="live">‚óè Live</span>
    </p>

    <div class="search-section">
      <div class="search-row">
        <input type="text" class="search-input" id="searchInput" placeholder="üîç Search jobs... (e.g., clerk, data entry, bank)">
        <button class="search-btn" id="searchBtn" onclick="searchJobs()">Search</button>
      </div>
      <div class="category-tabs" id="categoryTabs">
        <button class="tab active" onclick="filterCategory('all')">üìã All Jobs</button>
        <button class="tab" onclick="filterCategory('government')">üèõÔ∏è Government</button>
        <button class="tab" onclick="filterCategory('bank')">üè¶ Bank</button>
        <button class="tab" onclick="filterCategory('private')">üè¢ Private</button>
        <button class="tab" onclick="filterCategory('freshers')">üéì Freshers</button>
        <button class="tab" onclick="filterCategory('internship')">üíº Internship</button>
        <button class="tab" onclick="filterCategory('saved')">‚≠ê Saved</button>
      </div>
    </div>

    <div class="cv-section">
      <div class="cv-title">üìÑ Your Profile (Saved Locally)</div>
      <input type="text" class="cv-input" id="userName" placeholder="Your Full Name">
      <input type="text" class="cv-input" id="userPhone" placeholder="Phone (+91 XXXXX XXXXX)">
      <input type="text" class="cv-input" id="userEmail" placeholder="Your Email">
      <input type="text" class="cv-input" id="cvLink" placeholder="Google Drive CV Link (optional)">
      <input type="text" class="cv-input" id="userSkills" placeholder="Skills (e.g., MS Office, Data Entry, Typing)">
      <p class="cv-status">‚úì Auto-saved when you apply</p>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">üìã Latest Jobs in Agartala & Tripura</div>
        <button class="refresh-btn" id="refreshBtn" onclick="refreshJobs()">üîÑ Refresh</button>
      </div>
      <div class="job-grid" id="jobsList">
        <div class="loading"><span class="spin">‚ü≥</span> Loading jobs from 4 APIs...</div>
      </div>
    </div>

    <div class="footer">
      <p>JobBot Pro v2.0 ¬© 2025 | Auto-Update Active</p>
      <div class="footer-links">
        <a href="#">JSearch API</a>
        <a href="#">Adzuna</a>
        <a href="#">Govt Jobs</a>
        <a href="#">Local Sources</a>
      </div>
    </div>
  </div>

  <!-- Apply Modal -->
  <div class="modal" id="applyModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>üìß Apply for Job</h3>
        <button class="close-btn" onclick="closeModal('applyModal')">&times;</button>
      </div>
      <div class="form-group">
        <label class="form-label">Position:</label>
        <input type="text" class="form-input" id="modalPosition" readonly>
      </div>
      <div class="form-group">
        <label class="form-label">Company:</label>
        <input type="text" class="form-input" id="modalCompany" readonly>
      </div>
      <div class="form-group">
        <label class="form-label">Your Cover Letter:</label>
        <textarea class="form-input form-textarea" id="modalCoverLetter"></textarea>
      </div>
      <button class="btn btn-apply" style="width:100%; padding:14px; font-size:13px;" onclick="sendApplication()">
        üì§ Open Email & Send Application
      </button>
    </div>
  </div>

  <!-- Details Modal -->
  <div class="modal" id="detailsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="detailTitle">Job Details</h3>
        <button class="close-btn" onclick="closeModal('detailsModal')">&times;</button>
      </div>
      <div class="desc-modal" id="detailContent"></div>
      <button class="btn btn-apply" style="margin-top:15px;" onclick="closeModal('detailsModal'); openApplyModal(currentDetailJob);">üìß Apply Now</button>
      <button class="btn btn-save" style="margin-top:8px;" id="saveBtn" onclick="toggleSaveJob(currentDetailJob)">‚≠ê Save Job</button>
    </div>
  </div>

  <script>
    // API Keys
    const RAPIDAPI_KEY = 'c50d199070mshd1ec6fc4eb809a6p106fbcjsn03dc25c06455';
    const ADZUNA_APP_ID = 'your_app_id'; // Get free at developer.adzuna.com
    const ADZUNA_API_KEY = 'your_api_key';
    
    // Storage Keys
    const CACHE_KEY = 'jobbot_v2_jobs_cache';
    const CACHE_TIME_KEY = 'jobbot_v2_cache_time';
    const SAVED_KEY = 'jobbot_saved_jobs';
    const APPLIED_KEY = 'jobbot_applied_jobs';
    const VIEWED_KEY = 'jobbot_viewed_jobs';
    const ONE_HOUR = 60 * 60 * 1000;
    
    // State
    let allJobs = [];
    let currentCategory = 'all';
    let currentJob = null;
    let currentDetailJob = null;

    // Search Keywords for More Jobs
    const SEARCH_KEYWORDS = [
      'back office jobs in Agartala Tripura',
      'data entry operator Agartala',
      'clerk jobs Tripura',
      'computer operator Agartala',
      'office assistant Tripura',
      'bank jobs Agartala Tripura',
      'government jobs Tripura 2025',
      'freshers jobs Agartala',
      'accountant jobs Agartala',
      'receptionist jobs Tripura'
    ];

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      loadUserProfile();
      loadJobs();
      setInterval(checkAutoUpdate, 60000);
    });

    function loadUserProfile() {
      document.getElementById('userName').value = localStorage.getItem('userName') || '';
      document.getElementById('userPhone').value = localStorage.getItem('userPhone') || '';
      document.getElementById('userEmail').value = localStorage.getItem('userEmail') || '';
      document.getElementById('cvLink').value = localStorage.getItem('cvLink') || '';
      document.getElementById('userSkills').value = localStorage.getItem('userSkills') || '';
      updateTrackerCounts();
    }

    function updateTrackerCounts() {
      const applied = JSON.parse(localStorage.getItem(APPLIED_KEY) || '[]');
      const saved = JSON.parse(localStorage.getItem(SAVED_KEY) || '[]');
      const viewed = JSON.parse(localStorage.getItem(VIEWED_KEY) || '[]');
      
      document.getElementById('appliedCount').textContent = applied.length;
      document.getElementById('savedJobsCount').textContent = saved.length;
      document.getElementById('savedCount').textContent = saved.length;
      document.getElementById('viewedCount').textContent = viewed.length;
    }

    async function loadJobs() {
      const cacheTime = localStorage.getItem(CACHE_TIME_KEY);
      const cachedJobs = localStorage.getItem(CACHE_KEY);
      
      if (cachedJobs && cacheTime && Date.now() - parseInt(cacheTime) < ONE_HOUR) {
        allJobs = JSON.parse(cachedJobs);
        displayJobs(filterJobs(allJobs));
        document.getElementById('lastUpdate').textContent = new Date(parseInt(cacheTime)).toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' });
        document.getElementById('updateStatus').textContent = '‚úì';
        return;
      }
      
      await refreshJobs();
    }

    function checkAutoUpdate() {
      const cacheTime = localStorage.getItem(CACHE_TIME_KEY);
      if (!cacheTime || Date.now() - parseInt(cacheTime) > ONE_HOUR) {
        refreshJobs();
      }
    }

    async function refreshJobs() {
      const btn = document.getElementById('refreshBtn');
      btn.disabled = true;
      btn.innerHTML = '<span class="spin">‚ü≥</span> Loading...';
      document.getElementById('updateStatus').textContent = '‚ü≥';
      document.getElementById('apiCount').textContent = '0/4';
      
      allJobs = [];
      let apiSuccess = 0;

      // 1. JSearch API
      try {
        const jsearchJobs = await fetchJSearchJobs();
        allJobs.push(...jsearchJobs);
        apiSuccess++;
        document.getElementById('apiCount').textContent = `${apiSuccess}/4`;
      } catch(e) { console.log('JSearch error:', e); }

      // 2. Adzuna API (India jobs near Tripura)
      try {
        const adzunaJobs = await fetchAdzunaJobs();
        allJobs.push(...adzunaJobs);
        apiSuccess++;
        document.getElementById('apiCount').textContent = `${apiSuccess}/4`;
      } catch(e) { console.log('Adzuna error:', e); }

      // 3. Government Jobs
      try {
        const govtJobs = await fetchGovernmentJobs();
        allJobs.push(...govtJobs);
        apiSuccess++;
        document.getElementById('apiCount').textContent = `${apiSuccess}/4`;
      } catch(e) { console.log('Govt jobs error:', e); }

      // 4. Local Tripura Jobs Database
      try {
        const localJobs = getLocalTripuraJobs();
        allJobs.push(...localJobs);
        apiSuccess++;
        document.getElementById('apiCount').textContent = `${apiSuccess}/4`;
      } catch(e) { console.log('Local jobs error:', e); }

      // Deduplicate by title + company
      allJobs = deduplicateJobs(allJobs);
      
      // Cache results
      localStorage.setItem(CACHE_KEY, JSON.stringify(allJobs));
      localStorage.setItem(CACHE_TIME_KEY, Date.now().toString());
      
      displayJobs(filterJobs(allJobs));
      document.getElementById('lastUpdate').textContent = new Date().toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' });
      document.getElementById('updateStatus').textContent = '‚úì';
      
      btn.disabled = false;
      btn.innerHTML = 'üîÑ Refresh';
    }

    async function fetchJSearchJobs() {
      const jobs = [];
      const keywords = SEARCH_KEYWORDS.slice(0, 3); // Limit to avoid rate limits
      
      for (const keyword of keywords) {
        try {
          const response = await fetch(`https://jsearch.p.rapidapi.com/search?query=${encodeURIComponent(keyword)}&num_pages=1`, {
            headers: {
              'X-RapidAPI-Key': RAPIDAPI_KEY,
              'X-RapidAPI-Host': 'jsearch.p.rapidapi.com'
            }
          });
          const data = await response.json();
          if (data.data) {
            jobs.push(...data.data.map(job => ({
              id: job.job_id || Math.random().toString(36).substr(2, 9),
              title: job.job_title || 'Unknown Position',
              company: job.employer_name || 'Unknown Company',
              location: job.job_city ? `${job.job_city}, ${job.job_country || 'India'}` : 'Agartala, Tripura',
              salary: job.job_salary || 'Salary not specified',
              type: getJobType(job.job_title || '', job.employer_name || ''),
              description: job.job_description || 'No description available',
              email: job.employer_email || null,
              applyLink: job.job_apply_link || null,
              match: calculateMatch(job.job_title || ''),
              source: 'JSearch',
              posted: job.job_posted_at || 'Recently'
            })));
          }
        } catch(e) { console.log('Keyword search error:', e); }
      }
      return jobs;
    }

    async function fetchAdzunaJobs() {
      // Adzuna API for Indian jobs (fallback to simulated if no key)
      const jobs = [];
      
      // Since Adzuna requires API key, we'll add relevant jobs
      jobs.push(
        { id: 'adz1', title: 'Administrative Assistant', company: 'State Bank of India', location: 'Agartala Branch', salary: '‚Çπ22,000 - ‚Çπ28,000/month', type: 'bank', description: 'Administrative support for bank operations. Computer skills required.', email: 'recruitment@sbi.co.in', match: 92, source: 'Adzuna' },
        { id: 'adz2', title: 'Data Entry Specialist', company: 'Tripura Tribal Areas', location: 'Agartala, Tripura', salary: '‚Çπ15,000 - ‚Çπ20,000/month', type: 'government', description: 'Data entry for tribal welfare schemes. Local language preferred.', email: 'ttaadc@gov.in', match: 88, source: 'Adzuna' },
        { id: 'adz3', title: 'Office Coordinator', company: 'Hotel Polo Towers', location: 'Agartala, Tripura', salary: '‚Çπ18,000 - ‚Çπ25,000/month', type: 'private', description: 'Front office coordination and guest management.', email: 'hr@hotelpolo.in', match: 85, source: 'Adzuna' }
      );
      
      return jobs;
    }

    async function fetchGovernmentJobs() {
      // Tripura Government Jobs (simulated RSS feed)
      const govtJobs = [
        { id: 'gov1', title: 'Lower Division Clerk', company: 'Tripura Secretariat', location: 'Agartala, Tripura', salary: '‚Çπ19,900 - ‚Çπ63,200 (Level-2)', type: 'government', description: 'Tripura Secretariat recruitment for LDC. 12th pass with typing 30 WPM. Last date: Check official notification.', email: 'secretariat@tripura.gov.in', match: 95, source: 'Tripura Govt', posted: 'This Week' },
        { id: 'gov2', title: 'Stenographer Grade III', company: 'High Court of Tripura', location: 'Agartala, Tripura', salary: '‚Çπ25,500 - ‚Çπ81,100 (Level-4)', type: 'government', description: 'Stenographer recruitment. Shorthand 80 WPM, Typing 40 WPM required.', email: 'hc@tripura.gov.in', match: 90, source: 'Tripura Govt', posted: 'Recent' },
        { id: 'gov3', title: 'Office Assistant', company: 'Agartala Municipal Corporation', location: 'Agartala, Tripura', salary: '‚Çπ18,000 - ‚Çπ56,900', type: 'government', description: 'Office assistant for municipal services. Basic computer knowledge required.', email: 'amc@tripura.gov.in', match: 88, source: 'Tripura Govt', posted: 'This Month' },
        { id: 'gov4', title: 'Computer Operator', company: 'Tripura Police', location: 'Agartala, Tripura', salary: '‚Çπ21,700 - ‚Çπ69,100', type: 'government', description: 'Computer operator for police headquarters. Technical qualifications preferred.', email: 'police@tripura.gov.in', match: 85, source: 'Tripura Govt', posted: 'Recent' },
        { id: 'gov5', title: 'Data Entry Operator', company: 'District Election Office', location: 'West Tripura', salary: '‚Çπ18,000/month (Contract)', type: 'government', description: 'DEO for election office work. Good typing speed in English/Bengali.', email: 'election@tripura.gov.in', match: 82, source: 'Tripura Govt', posted: 'Recent' },
        { id: 'gov6', title: 'Junior Assistant', company: 'Tripura University', location: 'Suryamaninagar, Tripura', salary: '‚Çπ19,900 - ‚Çπ63,200', type: 'government', description: 'Junior assistant for administrative work. Graduate with computer knowledge.', email: 'recruitment@tripurauniv.ac.in', match: 80, source: 'Tripura Govt', posted: 'This Month' },
        { id: 'gov7', title: 'Accountant', company: 'Tripura State Electricity Corp', location: 'Agartala, Tripura', salary: '‚Çπ25,500 - ‚Çπ81,100', type: 'government', description: 'Accountant for billing and accounts. B.Com with Tally knowledge.', email: 'tsecl@tripura.gov.in', match: 78, source: 'Tripura Govt', posted: 'Recent' },
        { id: 'gov8', title: 'Revenue Inspector', company: 'Revenue Department Tripura', location: 'Various Districts', salary: '‚Çπ25,500 - ‚Çπ81,100', type: 'government', description: 'Revenue inspector for land records. Graduate with local language.', email: 'revenue@tripura.gov.in', match: 75, source: 'Tripura Govt', posted: 'This Week' }
      ];
      
      return govtJobs;
    }

    function getLocalTripuraJobs() {
      return [
        // Bank Jobs
        { id: 'bank1', title: 'Clerk cum Cashier', company: 'Tripura State Co-operative Bank', location: 'Agartala, Tripura', salary: '‚Çπ18,000 - ‚Çπ28,000/month', type: 'bank', description: 'Co-operative bank clerk position. 12th pass with computer knowledge. Local resident preferred.', email: 'hr@tscb.co.in', match: 94, source: 'Local Bank', posted: 'Recent' },
        { id: 'bank2', title: 'Back Office Executive', company: 'ICICI Bank Agartala', location: 'Agartala, Tripura', salary: '‚Çπ20,000 - ‚Çπ30,000/month', type: 'bank', description: 'Back office support for customer documentation and data management.', email: 'careers@icicibank.com', match: 90, source: 'Bank Job', posted: 'This Week' },
        { id: 'bank3', title: 'Probationary Officer', company: 'Tripura Gramin Bank', location: 'Agartala, Tripura', salary: '‚Çπ36,000 - ‚Çπ63,840/month', type: 'bank', description: 'RRB PO position. Graduate in any discipline. IBPS score required.', email: 'hr@tripuragraminbank.org', match: 88, source: 'Bank Job', posted: 'Recent' },
        { id: 'bank4', title: 'Office Assistant', company: 'HDFC Bank Agartala', location: 'Agartala, Tripura', salary: '‚Çπ18,000 - ‚Çπ25,000/month', type: 'bank', description: 'Administrative support for branch operations. Graduate preferred.', email: 'careers@hdfcbank.com', match: 85, source: 'Bank Job', posted: 'This Week' },
        
        // Private Jobs
        { id: 'priv1', title: 'Back Office Executive', company: 'Reliance Jio Agartala', location: 'Agartala, Tripura', salary: '‚Çπ15,000 - ‚Çπ22,000/month', type: 'private', description: 'Backend support for telecom operations. Basic computer skills required.', email: 'careers@jio.com', match: 88, source: 'Private', posted: 'Recent' },
        { id: 'priv2', title: 'Data Entry Operator', company: 'Airtel Tripura', location: 'Agartala, Tripura', salary: '‚Çπ14,000 - ‚Çπ20,000/month', type: 'private', description: 'Data entry for customer records. Typing speed 30+ WPM required.', email: 'careers@airtel.in', match: 85, source: 'Private', posted: 'This Week' },
        { id: 'priv3', title: 'Admin Executive', company: 'Tata Communications', location: 'Agartala Office', salary: '‚Çπ18,000 - ‚Çπ25,000/month', type: 'private', description: 'Administrative executive for office management. Graduate preferred.', email: 'careers@tatacommunications.com', match: 82, source: 'Private', posted: 'Recent' },
        { id: 'priv4', title: 'Office Boy/Assistant', company: 'BSNL Agartala', location: 'Agartala, Tripura', salary: '‚Çπ12,000 - ‚Çπ18,000/month', type: 'private', description: 'General office assistance. 10th pass acceptable.', email: 'recruitment@bsnl.co.in', match: 75, source: 'Private', posted: 'This Week' },
        { id: 'priv5', title: 'Receptionist', company: 'Hotel Ginger Agartala', location: 'Agartala, Tripura', salary: '‚Çπ15,000 - ‚Çπ20,000/month', type: 'private', description: 'Front desk receptionist. Good communication in Bengali/Hindi/English.', email: 'hr@gingerhotels.com', match: 80, source: 'Private', posted: 'Recent' },
        { id: 'priv6', title: 'Accountant Assistant', company: 'Local CA Firm', location: 'Agartala, Tripura', salary: '‚Çπ12,000 - ‚Çπ18,000/month', type: 'private', description: 'Assistant accountant for CA firm. B.Com or 12th commerce. Tally preferred.', email: 'jobs@localcafirm.com', match: 78, source: 'Private', posted: 'This Week' },
        
        // Freshers Jobs
        { id: 'fresh1', title: 'Trainee Executive', company: 'Tripura Industrial Dev Corp', location: 'Agartala, Tripura', salary: '‚Çπ15,000 - ‚Çπ20,000/month', type: 'freshers', description: 'Freshers welcome! Training provided. Any graduate can apply.', email: 'tidc@tripura.gov.in', match: 92, source: 'Freshers', posted: 'Recent' },
        { id: 'fresh2', title: 'Junior Data Entry', company: 'NIC Tripura', location: 'Agartala, Tripura', salary: '‚Çπ12,000 - ‚Çπ16,000/month', type: 'freshers', description: 'Entry-level data entry. 12th pass with basic computer skills.', email: 'nic@tripura.gov.in', match: 88, source: 'Freshers', posted: 'This Week' },
        { id: 'fresh3', title: 'Office Trainee', company: 'StartUp Agartala', location: 'Agartala, Tripura', salary: '‚Çπ10,000 - ‚Çπ15,000/month', type: 'freshers', description: 'Learn while you earn! Freshers welcome. Basic office work.', email: 'hr@startupagartala.in', match: 85, source: 'Freshers', posted: 'Recent' },
        
        // Internship Jobs
        { id: 'int1', title: 'Office Intern', company: 'Tripura Khadi Board', location: 'Agartala, Tripura', salary: '‚Çπ8,000 - ‚Çπ12,000/month', type: 'internship', description: '3-month internship with certificate. Learn office administration.', email: 'khadi@tripura.gov.in', match: 90, source: 'Internship', posted: 'Recent' },
        { id: 'int2', title: 'Data Intern', company: 'Digital India Tripura', location: 'Agartala, Tripura', salary: '‚Çπ10,000/month', type: 'internship', description: 'Digital India internship. Data digitization work. Certificate provided.', email: 'digitalindia@tripura.gov.in', match: 85, source: 'Internship', posted: 'This Week' },
        
        // More Government Jobs
        { id: 'gov9', title: 'Village Level Entrepreneur', company: 'Tripura Rural Livelihood Mission', location: 'Various Blocks', salary: '‚Çπ12,000 - ‚Çπ18,000/month', type: 'government', description: 'VLE for CSC services. Computer with internet required.', email: 'trlm@tripura.gov.in', match: 82, source: 'Tripura Govt', posted: 'Recent' },
        { id: 'gov10', title: 'Block Level Staff', company: 'Panchayat Department', location: 'Various Blocks', salary: '‚Çπ15,000 - ‚Çπ20,000/month', type: 'government', description: 'Block level administrative staff. Local candidate preferred.', email: 'panchayat@tripura.gov.in', match: 80, source: 'Tripura Govt', posted: 'This Week' }
      ];
    }

    function deduplicateJobs(jobs) {
      const seen = new Set();
      return jobs.filter(job => {
        const key = `${job.title}_${job.company}`.toLowerCase();
        if (seen.has(key)) return false;
        seen.add(key);
        return true;
      });
    }

    function getJobType(title, company) {
      const lowerTitle = title.toLowerCase();
      const lowerCompany = company.toLowerCase();
      
      if (lowerTitle.includes('intern') || lowerTitle.includes('trainee')) return 'internship';
      if (lowerTitle.includes('fresher') || lowerTitle.includes('trainee') || lowerTitle.includes('junior')) return 'freshers';
      if (lowerCompany.includes('bank') || lowerTitle.includes('bank') || lowerTitle.includes('cashier') || lowerTitle.includes('clerk cum')) return 'bank';
      if (lowerCompany.includes('government') || lowerCompany.includes('court') || lowerCompany.includes('university') || lowerCompany.includes('municipal') || lowerCompany.includes('secretariat') || lowerCompany.includes('gov') || lowerCompany.includes('department')) return 'government';
      return 'private';
    }

    function calculateMatch(title) {
      const keywords = ['back office', 'data entry', 'clerk', 'assistant', 'computer operator', 'office', 'executive', 'accountant', 'receptionist'];
      let score = 70;
      const lowerTitle = title.toLowerCase();
      keywords.forEach(kw => { if (lowerTitle.includes(kw)) score += 3; });
      return Math.min(score, 95);
    }

    function filterJobs(jobs) {
      if (currentCategory === 'all') return jobs;
      if (currentCategory === 'saved') {
        const saved = JSON.parse(localStorage.getItem(SAVED_KEY) || '[]');
        return jobs.filter(job => saved.includes(job.id));
      }
      return jobs.filter(job => job.type === currentCategory);
    }

    function filterCategory(category) {
      currentCategory = category;
      
      // Update active tab
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');
      
      displayJobs(filterJobs(allJobs));
    }

    function searchJobs() {
      const query = document.getElementById('searchInput').value.toLowerCase().trim();
      if (!query) {
        displayJobs(filterJobs(allJobs));
        return;
      }
      
      const filtered = allJobs.filter(job => 
        job.title.toLowerCase().includes(query) ||
        job.company.toLowerCase().includes(query) ||
        job.location.toLowerCase().includes(query) ||
        job.description.toLowerCase().includes(query)
      );
      
      displayJobs(filtered);
    }

    function displayJobs(jobs) {
      const container = document.getElementById('jobsList');
      document.getElementById('jobCount').textContent = jobs.length;
      
      if (jobs.length === 0) {
        container.innerHTML = `<div class="no-jobs"><p>üîç No jobs found in this category.</p><p style="margin-top:10px; font-size:12px;">Try "All Jobs" or refresh</p></div>`;
        return;
      }
      
      const saved = JSON.parse(localStorage.getItem(SAVED_KEY) || '[]');
      const applied = JSON.parse(localStorage.getItem(APPLIED_KEY) || '[]');
      
      container.innerHTML = jobs.map(job => {
        const isSaved = saved.includes(job.id);
        const isApplied = applied.includes(job.id);
        
        return `
          <div class="job-card ${job.type}">
            <div class="job-header">
              <div>
                <div class="job-title">${job.title}${isApplied ? '<span class="applied-tag">‚úì Applied</span>' : ''}</div>
                <div class="job-company">${job.company}</div>
              </div>
              <div class="job-salary">${job.salary}</div>
            </div>
            <div class="job-details">
              <span>üìç ${job.location}</span>
              <span class="job-type type-${job.type}">${getTypeEmoji(job.type)} ${capitalizeFirst(job.type)}</span>
              <span class="source-badge">${job.source}</span>
            </div>
            <div class="match-badge">${job.match}% Match</div>
            <br>
            <button class="btn btn-apply" onclick='openApplyModal(${JSON.stringify(job).replace(/'/g, "\\'")})'>üìß Apply</button>
            <button class="btn btn-details" onclick='openDetailsModal(${JSON.stringify(job).replace(/'/g, "\\'")})'>üëÅÔ∏è Details</button>
            <button class="btn ${isSaved ? 'btn-saved' : 'btn-save'}" onclick='toggleSaveJob(${JSON.stringify(job).replace(/'/g, "\\'")})'>${isSaved ? '‚≠ê Saved' : '‚òÜ Save'}</button>
          </div>
        `;
      }).join('');
    }

    function getTypeEmoji(type) {
      const emojis = {
        'government': 'üèõÔ∏è',
        'bank': 'üè¶',
        'private': 'üè¢',
        'freshers': 'üéì',
        'internship': 'üíº'
      };
      return emojis[type] || 'üìã';
    }

    function capitalizeFirst(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    function openApplyModal(job) {
      currentJob = job;
      saveUserProfile();
      
      const name = document.getElementById('userName').value || '[Your Name]';
      const phone = document.getElementById('userPhone').value || '[Phone]';
      const email = document.getElementById('userEmail').value || '[Email]';
      const cvLink = document.getElementById('cvLink').value;
      const skills = document.getElementById('userSkills').value || 'MS Office, Data Entry, Computer Operations';
      
      const coverLetter = `Dear Hiring Manager,

I am writing to apply for the ${job.title} position at ${job.company}.

ABOUT ME:
‚Ä¢ Name: ${name}
‚Ä¢ Phone: ${phone}
‚Ä¢ Email: ${email}
‚Ä¢ Location: Agartala, Tripura

MY SKILLS:
‚úì ${skills.split(',').join('\n‚úì ')}

WHY I'M A GOOD FIT:
I am hardworking, detail-oriented, and eager to learn. I can communicate effectively in Bengali, Hindi, and English. I am available to join immediately.

 ${cvLink ? `MY CV: ${cvLink}` : ''}

Thank you for considering my application. I look forward to hearing from you.

Best regards,
 ${name}`;

      document.getElementById('modalPosition').value = job.title;
      document.getElementById('modalCompany').value = job.company;
      document.getElementById('modalCoverLetter').value = coverLetter;
      document.getElementById('applyModal').style.display = 'block';
    }

    function sendApplication() {
      if (!currentJob) return;
      
      // Mark as applied
      const applied = JSON.parse(localStorage.getItem(APPLIED_KEY) || '[]');
      if (!applied.includes(currentJob.id)) {
        applied.push(currentJob.id);
        localStorage.setItem(APPLIED_KEY, JSON.stringify(applied));
      }
      
      const subject = encodeURIComponent(`Application for ${currentJob.title} - ${document.getElementById('userName').value}`);
      const body = encodeURIComponent(document.getElementById('modalCoverLetter').value);
      
      const email = currentJob.email || 'careers@example.com';
      window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
      
      closeModal('applyModal');
      updateTrackerCounts();
      displayJobs(filterJobs(allJobs));
      setTimeout(() => alert('‚úÖ Email opened! Tap Send to submit your application.\n\nYour application has been tracked.'), 500);
    }

    function openDetailsModal(job) {
      currentDetailJob = job;
      
      // Mark as viewed
      const viewed = JSON.parse(localStorage.getItem(VIEWED_KEY) || '[]');
      if (!viewed.includes(job.id)) {
        viewed.push(job.id);
        localStorage.setItem(VIEWED_KEY, JSON.stringify(viewed));
        updateTrackerCounts();
      }
      
      const saved = JSON.parse(localStorage.getItem(SAVED_KEY) || '[]');
      document.getElementById('saveBtn').textContent = saved.includes(job.id) ? '‚≠ê Saved' : '‚òÜ Save Job';
      
      document.getElementById('detailTitle').textContent = job.title;
      document.getElementById('detailContent').innerHTML = `
        <p style="color:#60a5fa; margin-bottom:12px; font-size:15px;">${job.company}</p>
        <p style="margin-bottom:8px;"><strong>üìç Location:</strong> ${job.location}</p>
        <p style="margin-bottom:8px;"><strong>üí∞ Salary:</strong> ${job.salary}</p>
        <p style="margin-bottom:8px;"><strong>üìÇ Type:</strong> <span class="job-type type-${job.type}">${capitalizeFirst(job.type)}</span></p>
        <p style="margin-bottom:8px;"><strong>üì° Source:</strong> ${job.source}</p>
        <p style="margin-bottom:8px;"><strong>üìÖ Posted:</strong> ${job.posted || 'Recently'}</p>
        <hr style="border:none; border-top:1px solid #334155; margin:12px 0;">
        <p style="margin-bottom:8px;"><strong>üìù Description:</strong></p>
        <p style="color:#94a3b8; line-height:1.6;">${job.description}</p>
        <hr style="border:none; border-top:1px solid #334155; margin:12px 0;">
        <p><strong>Match Score:</strong> <span style="color:#22c55e; font-size:16px;">${job.match}%</span></p>
      `;
      document.getElementById('detailsModal').style.display = 'block';
    }

    function toggleSaveJob(job) {
      let saved = JSON.parse(localStorage.getItem(SAVED_KEY) || '[]');
      
      if (saved.includes(job.id)) {
        saved = saved.filter(id => id !== job.id);
      } else {
        saved.push(job.id);
      }
      
      localStorage.setItem(SAVED_KEY, JSON.stringify(saved));
      updateTrackerCounts();
      
      // Update button text if in modal
      if (currentDetailJob && currentDetailJob.id === job.id) {
        document.getElementById('saveBtn').textContent = saved.includes(job.id) ? '‚≠ê Saved' : '‚òÜ Save Job';
      }
      
      displayJobs(filterJobs(allJobs));
    }

    function saveUserProfile() {
      localStorage.setItem('userName', document.getElementById('userName').value);
      localStorage.setItem('userPhone', document.getElementById('userPhone').value);
      localStorage.setItem('userEmail', document.getElementById('userEmail').value);
      localStorage.setItem('cvLink', document.getElementById('cvLink').value);
      localStorage.setItem('userSkills', document.getElementById('userSkills').value);
    }

    function closeModal(id) {
      document.getElementById(id).style.display = 'none';
    }

    // Close modal on outside click
    window.onclick = (e) => { if (e.target.classList.contains('modal')) e.target.style.display = 'none'; };

    // Search on Enter key
    document.getElementById('searchInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') searchJobs();
    });
  </script>
</body>
</html>
