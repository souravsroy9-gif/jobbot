<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JobBot Pro - Find Jobs in Agartala, Tripura</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Poppins', sans-serif; }
        body { background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #0f0f23 100%); min-height: 100vh; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .glow { box-shadow: 0 0 30px rgba(16, 185, 129, 0.2); }
        .gradient-text { background: linear-gradient(90deg, #10b981, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .scroll-hidden::-webkit-scrollbar { display: none; }
        .tab-btn.active { background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(6, 182, 212, 0.2)); border-color: rgba(16, 185, 129, 0.5); color: #10b981; }
        .job-card { transition: all 0.3s ease; }
        .job-card:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(16, 185, 129, 0.15); }
        .btn-primary { background: linear-gradient(135deg, #10b981, #059669); }
        .btn-primary:hover { background: linear-gradient(135deg, #059669, #047857); }
        .btn-telegram { background: linear-gradient(135deg, #0088cc, #0077b5); }
        input:focus { outline: none; border-color: #10b981; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2); }
        .slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
        .loader { width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.1); border-top-color: #10b981; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="text-white">
    <!-- Header -->
    <header class="sticky top-0 z-40 glass">
        <div class="max-w-5xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-11 h-11 rounded-xl bg-gradient-to-br from-emerald-500 to-cyan-500 flex items-center justify-center glow">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold gradient-text">JobBot Pro</h1>
                        <p class="text-xs text-slate-400">Agartala, Tripura</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <span id="jobCounter" class="text-xs bg-emerald-500/20 text-emerald-400 px-3 py-1 rounded-full border border-emerald-500/30 font-medium">0 Jobs</span>
                    <button onclick="openSettings()" class="p-2.5 glass rounded-xl hover:bg-white/10">âš™ï¸</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Search -->
    <div class="max-w-5xl mx-auto px-4 py-4">
        <div class="glass rounded-2xl p-4 mb-4">
            <div class="flex gap-2">
                <input id="searchInput" type="text" placeholder="Search jobs... (Clerk, Back Office, Data Entry)" class="flex-1 bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-slate-500" onkeypress="if(event.key==='Enter')searchJobs()">
                <button onclick="searchJobs()" class="btn-primary text-white px-6 py-3 rounded-xl font-semibold">ğŸ” Search</button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="flex gap-2 overflow-x-auto scroll-hidden pb-3 mb-4">
            <button onclick="filterCategory('all',this)" class="tab-btn active px-4 py-2 rounded-xl border border-white/10 text-sm font-medium whitespace-nowrap glass">ğŸ“‹ All</button>
            <button onclick="filterCategory('government',this)" class="tab-btn px-4 py-2 rounded-xl border border-white/10 text-sm font-medium whitespace-nowrap glass hover:bg-white/5">ğŸ›ï¸ Government</button>
            <button onclick="filterCategory('bank',this)" class="tab-btn px-4 py-2 rounded-xl border border-white/10 text-sm font-medium whitespace-nowrap glass hover:bg-white/5">ğŸ¦ Bank</button>
            <button onclick="filterCategory('private',this)" class="tab-btn px-4 py-2 rounded-xl border border-white/10 text-sm font-medium whitespace-nowrap glass hover:bg-white/5">ğŸ¢ Private</button>
            <button onclick="filterCategory('fresher',this)" class="tab-btn px-4 py-2 rounded-xl border border-white/10 text-sm font-medium whitespace-nowrap glass hover:bg-white/5">ğŸ“ Freshers</button>
            <button onclick="filterCategory('saved',this)" class="tab-btn px-4 py-2 rounded-xl border border-white/10 text-sm font-medium whitespace-nowrap glass hover:bg-white/5">â­ Saved</button>
        </div>

        <!-- Stats -->
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4">
            <div class="glass rounded-xl p-4 text-center"><p class="text-2xl font-bold" id="statTotal">0</p><p class="text-xs text-slate-400">Jobs Found</p></div>
            <div class="glass rounded-xl p-4 text-center"><p class="text-2xl font-bold text-emerald-400" id="statApplied">0</p><p class="text-xs text-slate-400">Applied</p></div>
            <div class="glass rounded-xl p-4 text-center"><p class="text-2xl font-bold text-yellow-400" id="statSaved">0</p><p class="text-xs text-slate-400">Saved</p></div>
            <div class="glass rounded-xl p-4 text-center"><p class="text-2xl font-bold text-cyan-400" id="statMatch">0</p><p class="text-xs text-slate-400">Best Match</p></div>
        </div>

        <!-- Loading -->
        <div id="loadingState" class="hidden flex flex-col items-center py-16"><div class="loader mb-4"></div><p class="text-slate-400 text-sm">Searching jobs...</p></div>

        <!-- Empty -->
        <div id="emptyState" class="hidden flex flex-col items-center py-16"><div class="text-6xl mb-4">ğŸ”</div><h3 class="text-xl font-semibold mb-2">No Jobs Found</h3><button onclick="searchJobs()" class="btn-primary text-white px-6 py-2 rounded-xl">Refresh</button></div>

        <!-- Jobs List -->
        <div id="jobsList" class="space-y-3"></div>
    </main>

    <!-- Job Modal -->
    <div id="jobModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/70" onclick="closeJobModal()"></div>
        <div class="absolute right-0 top-0 bottom-0 w-full max-w-lg bg-slate-900 border-l border-white/10 overflow-y-auto slide-in">
            <div id="jobModalContent" class="p-6"></div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/70" onclick="closeSettings()"></div>
        <div class="absolute right-0 top-0 bottom-0 w-full max-w-md bg-slate-900 border-l border-white/10 overflow-y-auto slide-in">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold">Settings</h2>
                    <button onclick="closeSettings()" class="p-2 glass rounded-lg">âœ•</button>
                </div>
                <div class="mb-6">
                    <h3 class="text-sm font-semibold text-slate-400 uppercase mb-3">Your Profile</h3>
                    <div class="space-y-3">
                        <input id="settingsName" type="text" placeholder="Full Name" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-white">
                        <input id="settingsEmail" type="email" placeholder="Email" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-white">
                        <input id="settingsPhone" type="tel" placeholder="Phone (+91 XXXXX XXXXX)" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-white">
                    </div>
                </div>
                <div class="mb-6">
                    <h3 class="text-sm font-semibold text-slate-400 uppercase mb-3">Job Preferences</h3>
                    <div class="space-y-3">
                        <input id="settingsJobTitle" type="text" placeholder="Job Title (Back Office, Clerk...)" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-white">
                        <input id="settingsSkills" type="text" placeholder="Skills (MS Office, Tally...)" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-white">
                    </div>
                </div>
                <div class="mb-6">
                    <h3 class="text-sm font-semibold text-slate-400 uppercase mb-3">ğŸ“± Telegram Alerts</h3>
                    <div class="glass rounded-xl p-3 mb-3 text-xs text-slate-300">
                        <p class="text-cyan-400 font-medium mb-1">Setup:</p>
                        <ol class="list-decimal list-inside">
                            <li>Search @BotFather â†’ /newbot â†’ Get Token</li>
                            <li>Search @userinfobot â†’ Get Chat ID</li>
                        </ol>
                    </div>
                    <div class="space-y-3">
                        <input id="settingsTelegramToken" type="password" placeholder="Bot Token" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-white">
                        <input id="settingsTelegramChatId" type="text" placeholder="Chat ID" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-white">
                        <button onclick="testTelegram()" class="w-full btn-telegram text-white py-2.5 rounded-xl font-medium">ğŸ“¨ Test Telegram</button>
                    </div>
                </div>
                <button onclick="saveSettings()" class="w-full btn-primary text-white py-3 rounded-xl font-semibold">ğŸ’¾ Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-6 left-1/2 -translate-x-1/2 z-50 hidden"><div class="glass px-5 py-3 rounded-xl"><p id="toastMessage" class="text-sm"></p></div></div>

    <script>
        const API_KEY = 'c50d199070mshd1ec6fc4eb809a6p106fbcjsn03dc25c06455';
        let allJobs = [], currentCategory = 'all';
        let savedJobs = JSON.parse(localStorage.getItem('jobbot_saved')) || [];
        let appliedJobs = JSON.parse(localStorage.getItem('jobbot_applied')) || [];
        let userProfile = JSON.parse(localStorage.getItem('jobbot_profile')) || {};

        const localJobs = [
            {id:'local-1',title:'Office Assistant',company:'Tripura Secretariat',location:'Agartala, Tripura',salary:'â‚¹21,700 - â‚¹69,100',category:'government',description:'Office Assistant at Tripura Secretariat. 12th pass with computer knowledge required.',requirements:['12th Pass','Computer Knowledge','Typing 30 WPM'],posted:'2 days ago',deadline:'15 days left',url:'https://tripura.gov.in',match:88},
            {id:'local-2',title:'Clerk cum Computer Operator',company:'District Court Agartala',location:'Agartala, Tripura',salary:'â‚¹19,900 - â‚¹63,200',category:'government',description:'Clerk cum Computer Operator at District Court. Graduate with computer skills.',requirements:['Graduate','Computer Skills','Typing'],posted:'5 days ago',deadline:'20 days left',url:'https://districts.ecourts.gov.in/tripura',match:92},
            {id:'local-3',title:'Back Office Executive',company:'Tripura State Co-operative Bank',location:'Agartala, Tripura',salary:'â‚¹22,000 - â‚¹35,000',category:'bank',description:'Back Office Executive at Tripura State Co-operative Bank.',requirements:['Graduate','Basic Computer','Communication'],posted:'3 days ago',deadline:'25 days left',url:'https://tscbank.in',match:95},
            {id:'local-4',title:'Data Entry Operator',company:'Tribal Welfare Department',location:'Agartala, Tripura',salary:'â‚¹18,000 - â‚¹25,000',category:'government',description:'Data Entry Operator for government schemes.',requirements:['12th Pass','Typing 35 WPM','Computer'],posted:'1 day ago',deadline:'10 days left',url:'https://tribal.nic.in',match:85},
            {id:'local-5',title:'Junior Assistant',company:'BSNL Agartala',location:'Agartala, Tripura',salary:'â‚¹21,700 - â‚¹69,100',category:'government',description:'Junior Assistant at BSNL Agartala office.',requirements:['12th Pass','Computer Knowledge'],posted:'1 week ago',deadline:'30 days left',url:'https://bsnl.co.in',match:82},
            {id:'local-6',title:'Office Computer Assistant',company:'Agartala Municipal Council',location:'Agartala, Tripura',salary:'â‚¹17,000 - â‚¹28,000',category:'government',description:'Office and computer assistant for municipal work.',requirements:['12th Pass','MS Office','Typing'],posted:'4 days ago',deadline:'18 days left',url:'https://agartalacity.gov.in',match:87},
            {id:'local-7',title:'Fresher - Back Office',company:'ICICI Bank',location:'Agartala, Tripura',salary:'â‚¹18,000 - â‚¹25,000',category:'fresher',description:'Fresher opening at ICICI Bank Agartala. Training provided.',requirements:['Graduate','Freshers Welcome','Computer'],posted:'1 day ago',deadline:'7 days left',url:'https://icicicareers.com',match:90},
            {id:'local-8',title:'Computer Operator',company:'State Bank of India',location:'Agartala, Tripura',salary:'â‚¹20,000 - â‚¹32,000',category:'bank',description:'Computer Operator at SBI Agartala branch.',requirements:['Graduate','Computer Skills','Banking'],posted:'2 days ago',deadline:'14 days left',url:'https://sbi.co.in/careers',match:88}
        ];

        document.addEventListener('DOMContentLoaded', () => { loadSettingsToForm(); searchJobs(); });

        async function searchJobs() {
            showLoading(true);
            const searchTerm = document.getElementById('searchInput').value;
            const query = searchTerm || 'back office clerk jobs Agartala Tripura India';
            
            let apiJobs = [];
            try {
                const res = await fetch(`https://jsearch.p.rapidapi.com/search?query=${encodeURIComponent(query)}&num=10&page=1&country=in`, {
                    headers: { 'X-RapidAPI-Key': API_KEY, 'X-RapidAPI-Host': 'jsearch.p.rapidapi.com' }
                });
                const data = await res.json();
                apiJobs = (data.data || []).map(j => ({
                    id: 'api-' + j.job_id,
                    title: j.job_title || 'Job Opening',
                    company: j.employer_name || 'Company',
                    location: j.job_city ? `${j.job_city}, India` : 'Agartala, Tripura',
                    salary: j.job_min_salary ? `â‚¹${j.job_min_salary?.toLocaleString()}+` : 'As per industry',
                    category: (j.employer_name||'').toLowerCase().includes('bank') ? 'bank' : (j.job_title||'').toLowerCase().includes('fresher') ? 'fresher' : 'private',
                    description: j.job_description?.substring(0,200) || 'Apply now.',
                    requirements: [],
                    posted: 'Recently',
                    deadline: 'Apply soon',
                    url: j.job_apply_link || '#',
                    match: Math.min(50 + (j.job_city?.toLowerCase().includes('agartala') ? 20 : 0), 85)
                }));
            } catch(e) { console.log('API error'); }
            
            allJobs = [...localJobs, ...apiJobs];
            const seen = new Set();
            allJobs = allJobs.filter(j => !seen.has(j.title+j.company) && seen.add(j.title+j.company));
            
            filterCategory(currentCategory);
            showLoading(false);
            updateStats();
        }

        function filterCategory(cat, btn) {
            currentCategory = cat;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            let filtered = cat === 'saved' ? allJobs.filter(j => savedJobs.includes(j.id)) : cat === 'all' ? allJobs : allJobs.filter(j => j.category === cat);
            renderJobs(filtered);
        }

        function renderJobs(jobs) {
            const container = document.getElementById('jobsList');
            document.getElementById('emptyState').classList.toggle('hidden', jobs.length > 0);
            document.getElementById('jobCounter').textContent = jobs.length + ' Jobs';
            
            const icons = {government:'ğŸ›ï¸',bank:'ğŸ¦',private:'ğŸ¢',fresher:'ğŸ“'};
            container.innerHTML = jobs.map(j => `
                <div class="glass rounded-xl p-4 job-card cursor-pointer" onclick="openJobModal('${j.id}')">
                    <div class="flex items-start gap-4">
                        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-slate-700 to-slate-800 flex items-center justify-center text-2xl">${icons[j.category]||'ğŸ“‹'}</div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between gap-2">
                                <h3 class="font-semibold truncate">${j.title}</h3>
                                <button onclick="event.stopPropagation();toggleSave('${j.id}')" class="text-xl">${savedJobs.includes(j.id)?'â­':'â˜†'}</button>
                            </div>
                            <p class="text-sm text-slate-400 mb-2">${j.company}</p>
                            <div class="flex items-center gap-3 text-xs text-slate-500">
                                <span>ğŸ“ ${j.location}</span>
                                <span>ğŸ’° ${j.salary}</span>
                            </div>
                            <div class="flex items-center justify-between mt-3">
                                <div class="flex items-center gap-2">
                                    <div class="w-16 h-1.5 bg-slate-700 rounded-full overflow-hidden"><div class="h-full ${j.match>=85?'bg-emerald-500':'bg-yellow-500'}" style="width:${j.match}%"></div></div>
                                    <span class="text-xs ${j.match>=85?'text-emerald-400':'text-yellow-400'}">${j.match}%</span>
                                </div>
                                <span class="text-xs text-slate-500">${j.posted}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function openJobModal(id) {
            const j = allJobs.find(x => x.id === id);
            if(!j) return;
            document.getElementById('jobModalContent').innerHTML = `
                <div class="flex items-center justify-between mb-6">
                    <button onclick="closeJobModal()" class="p-2 glass rounded-lg">â† Back</button>
                    <div class="flex gap-2">
                        <button onclick="shareJob('${j.id}')" class="p-2 glass rounded-lg">ğŸ“¤</button>
                        <button onclick="toggleSave('${j.id}')" class="p-2 glass rounded-lg text-xl">${savedJobs.includes(j.id)?'â­':'â˜†'}</button>
                    </div>
                </div>
                <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-slate-700 to-slate-800 flex items-center justify-center text-3xl mb-4">ğŸ“‹</div>
                <h2 class="text-xl font-bold mb-1">${j.title}</h2>
                <p class="text-slate-400 mb-4">${j.company}</p>
                <div class="flex items-center gap-2 mb-4">
                    <div class="w-20 h-2 bg-slate-700 rounded-full overflow-hidden"><div class="h-full ${j.match>=85?'bg-emerald-500':'bg-yellow-500'}" style="width:${j.match}%"></div></div>
                    <span class="text-sm ${j.match>=85?'text-emerald-400':'text-yellow-400'}">${j.match}% Match</span>
                </div>
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <div class="glass rounded-xl p-3"><p class="text-xs text-slate-400">Location</p><p class="text-sm font-medium">${j.location}</p></div>
                    <div class="glass rounded-xl p-3"><p class="text-xs text-slate-400">Salary</p><p class="text-sm font-medium">${j.salary}</p></div>
                    <div class="glass rounded-xl p-3"><p class="text-xs text-slate-400">Posted</p><p class="text-sm font-medium">${j.posted}</p></div>
                    <div class="glass rounded-xl p-3"><p class="text-xs text-slate-400">Deadline</p><p class="text-sm text-yellow-400 font-medium">${j.deadline}</p></div>
                </div>
                <div class="mb-4"><h3 class="text-sm font-semibold mb-2">Description</h3><p class="text-sm text-slate-300">${j.description}</p></div>
                ${j.requirements?.length?`<div class="mb-6"><h3 class="text-sm font-semibold mb-2">Requirements</h3><div class="flex flex-wrap gap-2">${j.requirements.map(r=>`<span class="text-xs bg-white/5 border border-white/10 px-3 py-1 rounded-full">${r}</span>`).join('')}</div></div>`:''}
                <div class="space-y-3">
                    <button onclick="applyToJob('${j.id}')" class="w-full btn-primary text-white py-3 rounded-xl font-semibold">ğŸ“§ Apply Now</button>
                    <button onclick="sendToTelegram('${j.id}')" class="w-full btn-telegram text-white py-3 rounded-xl font-medium">ğŸ“¨ Send to Telegram</button>
                    ${j.url?`<a href="${j.url}" target="_blank" class="block w-full text-center glass py-3 rounded-xl hover:bg-white/10">ğŸ”— Open Original</a>`:''}
                </div>
            `;
            document.getElementById('jobModal').classList.remove('hidden');
        }
        function closeJobModal() { document.getElementById('jobModal').classList.add('hidden'); }

        function toggleSave(id) {
            if(savedJobs.includes(id)) { savedJobs = savedJobs.filter(x => x !== id); showToast('Removed'); }
            else { savedJobs.push(id); showToast('Saved!'); }
            localStorage.setItem('jobbot_saved', JSON.stringify(savedJobs));
            filterCategory(currentCategory); updateStats();
        }

        function applyToJob(id) {
            const j = allJobs.find(x => x.id === id);
            if(!j) return;
            if(!appliedJobs.includes(id)) { appliedJobs.push(id); localStorage.setItem('jobbot_applied', JSON.stringify(appliedJobs)); updateStats(); }
            const subject = encodeURIComponent(`Application for ${j.title}`);
            const body = encodeURIComponent(`Dear Hiring Manager,\n\nI am applying for ${j.title} at ${j.company}.\n\nName: ${userProfile.name||''}\nEmail: ${userProfile.email||''}\nPhone: ${userProfile.phone||''}\n\nThank you!`);
            window.open(`mailto:?subject=${subject}&body=${body}`);
            showToast('Opening email...');
        }

        function shareJob(id) {
            const j = allJobs.find(x => x.id === id);
            if(!j) return;
            const text = `${j.title} at ${j.company}\nğŸ“ ${j.location}\nğŸ’° ${j.salary}\n${j.url||''}`;
            if(navigator.share) navigator.share({title:j.title, text});
            else { navigator.clipboard.writeText(text); showToast('Copied!'); }
        }

        async function sendToTelegram(id) {
            const j = allJobs.find(x => x.id === id);
            if(!j) return;
            const token = userProfile.telegramToken, chatId = userProfile.telegramChatId;
            if(!token||!chatId) { showToast('Setup Telegram in Settings'); closeJobModal(); openSettings(); return; }
            try {
                const res = await fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
                    method:'POST', headers:{'Content-Type':'application/json'},
                    body: JSON.stringify({chat_id:chatId, text:`ğŸŒŸ *${j.title}*\nğŸ“ ${j.company}, ${j.location}\nğŸ’° ${j.salary}\n\n${j.url||''}`, parse_mode:'Markdown'})
                });
                const data = await res.json();
                showToast(data.ok ? 'Sent!' : 'Error: '+data.description);
            } catch(e) { showToast('Failed'); }
        }

        function openSettings() { document.getElementById('settingsModal').classList.remove('hidden'); }
        function closeSettings() { document.getElementById('settingsModal').classList.add('hidden'); }
        function loadSettingsToForm() {
            document.getElementById('settingsName').value = userProfile.name || '';
            document.getElementById('settingsEmail').value = userProfile.email || '';
            document.getElementById('settingsPhone').value = userProfile.phone || '';
            document.getElementById('settingsJobTitle').value = userProfile.jobTitle || '';
            document.getElementById('settingsSkills').value = userProfile.skills || '';
            document.getElementById('settingsTelegramToken').value = userProfile.telegramToken || '';
            document.getElementById('settingsTelegramChatId').value = userProfile.telegramChatId || '';
        }
        function saveSettings() {
            userProfile = {
                name: document.getElementById('settingsName').value,
                email: document.getElementById('settingsEmail').value,
                phone: document.getElementById('settingsPhone').value,
                jobTitle: document.getElementById('settingsJobTitle').value,
                skills: document.getElementById('settingsSkills').value,
                telegramToken: document.getElementById('settingsTelegramToken').value,
                telegramChatId: document.getElementById('settingsTelegramChatId').value
            };
            localStorage.setItem('jobbot_profile', JSON.stringify(userProfile));
            showToast('Saved!'); closeSettings(); searchJobs();
        }

        async function testTelegram() {
            const token = document.getElementById('settingsTelegramToken').value;
            const chatId = document.getElementById('settingsTelegramChatId').value;
            if(!token||!chatId) { showToast('Enter Token & Chat ID'); return; }
            try {
                const res = await fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
                    method:'POST', headers:{'Content-Type':'application/json'},
                    body: JSON.stringify({chat_id:chatId, text:'âœ… JobBot Pro Connected!\n\nYou will receive job alerts here.', parse_mode:'Markdown'})
                });
                const data = await res.json();
                showToast(data.ok ? 'Check Telegram!' : 'Error: '+data.description);
            } catch(e) { showToast('Failed'); }
        }

        function showLoading(show) {
            document.getElementById('loadingState').classList.toggle('hidden', !show);
            document.getElementById('jobsList').classList.toggle('hidden', show);
        }
        function updateStats() {
            document.getElementById('statTotal').textContent = allJobs.length;
            document.getElementById('statApplied').textContent = appliedJobs.length;
            document.getElementById('statSaved').textContent = savedJobs.length;
            document.getElementById('statMatch').textContent = allJobs.filter(j=>j.match>=85).length;
        }
        function showToast(msg) {
            document.getElementById('toastMessage').textContent = msg;
            document.getElementById('toast').classList.remove('hidden');
            setTimeout(() => document.getElementById('toast').classList.add('hidden'), 3000);
        }
    </script>
</body>
</html>
