<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JobBot Pro - Agartala Jobs | Auto-Update Every Hour</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      min-height: 100vh;
      color: white;
      padding: 15px;
    }
    .container { max-width: 900px; margin: 0 auto; }
    .header { text-align: center; padding: 20px 0; margin-bottom: 20px; }
    .logo { font-size: 32px; margin-bottom: 5px; }
    h1 { font-size: 24px; margin-bottom: 5px; background: linear-gradient(90deg, #22c55e, #3b82f6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .subtitle { color: #94a3b8; font-size: 14px; }
    .stats-bar { display: flex; justify-content: center; gap: 12px; margin: 20px 0; flex-wrap: wrap; }
    .stat-item { text-align: center; padding: 10px 15px; background: #1e293b; border-radius: 10px; border: 1px solid #334155; }
    .stat-num { font-size: 20px; font-weight: bold; color: #22c55e; }
    .stat-label { font-size: 10px; color: #94a3b8; }
    .card { background: #1e293b; border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid #334155; }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .card-title { font-size: 16px; font-weight: bold; }
    .refresh-btn { background: #22c55e; color: #000; border: none; padding: 8px 16px; border-radius: 8px; font-weight: bold; cursor: pointer; }
    .refresh-btn:disabled { background: #64748b; }
    .job-grid { display: grid; gap: 12px; }
    .job-card { background: #334155; border-radius: 10px; padding: 15px; border-left: 4px solid #22c55e; }
    .job-card.government { border-left-color: #f97316; }
    .job-card.bank { border-left-color: #3b82f6; }
    .job-card.private { border-left-color: #a855f7; }
    .job-header { display: flex; justify-content: space-between; margin-bottom: 8px; }
    .job-title { font-size: 15px; font-weight: bold; }
    .job-salary { color: #22c55e; font-size: 13px; font-weight: bold; text-align: right; }
    .job-company { color: #60a5fa; font-size: 13px; margin-bottom: 5px; }
    .job-details { display: flex; gap: 12px; color: #94a3b8; font-size: 12px; margin-bottom: 8px; flex-wrap: wrap; }
    .match-badge { background: #166534; color: #86efac; padding: 4px 10px; border-radius: 15px; font-size: 11px; }
    .job-type { font-size: 10px; padding: 3px 8px; border-radius: 4px; }
    .type-government { background: #f97316; color: white; }
    .type-bank { background: #3b82f6; color: white; }
    .type-private { background: #a855f7; color: white; }
    .btn { padding: 8px 14px; border-radius: 8px; border: none; cursor: pointer; font-size: 12px; font-weight: bold; margin-top: 10px; margin-right: 5px; text-decoration: none; display: inline-block; }
    .btn-apply { background: #22c55e; color: #000; }
    .btn-details { background: #3b82f6; color: white; }
    .update-time { text-align: center; color: #64748b; font-size: 12px; margin-bottom: 15px; }
    .update-time .live { color: #22c55e; }
    .no-jobs { text-align: center; padding: 40px; color: #94a3b8; }
    .loading { text-align: center; padding: 40px; color: #60a5fa; }
    .footer { text-align: center; padding: 20px; color: #64748b; font-size: 12px; }
    .cv-section { background: linear-gradient(135deg, #1e40af, #7c3aed); border-radius: 12px; padding: 15px; margin-bottom: 15px; }
    .cv-title { font-size: 14px; margin-bottom: 10px; }
    .cv-input { width: 100%; padding: 10px; border-radius: 8px; border: none; background: rgba(255,255,255,0.1); color: white; margin-bottom: 8px; font-size: 13px; }
    .cv-input::placeholder { color: rgba(255,255,255,0.5); }
    .cv-status { font-size: 11px; color: #86efac; }
    .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); z-index: 1000; padding: 15px; overflow-y: auto; }
    .modal-content { background: #1e293b; border-radius: 15px; padding: 20px; max-width: 500px; margin: 30px auto; }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .close-btn { background: none; border: none; color: #94a3b8; font-size: 28px; cursor: pointer; }
    .form-group { margin-bottom: 15px; }
    .form-label { display: block; margin-bottom: 5px; color: #94a3b8; font-size: 13px; }
    .form-input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; font-size: 14px; }
    .form-textarea { height: 150px; resize: vertical; }
    .desc-modal { color: #cbd5e1; line-height: 1.6; font-size: 14px; }
    .desc-modal strong { color: #60a5fa; }
    .spin { animation: spin 1s linear infinite; display: inline-block; }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">ü§ñ</div>
      <h1>JobBot Pro</h1>
      <p class="subtitle">üìç Agartala, Tripura | Back Office Jobs | Auto-Update Every Hour</p>
    </div>

    <div class="stats-bar">
      <div class="stat-item">
        <div class="stat-num" id="jobCount">0</div>
        <div class="stat-label">Jobs Found</div>
      </div>
      <div class="stat-item">
        <div class="stat-num">‚Çπ15-30K</div>
        <div class="stat-label">Salary/Month</div>
      </div>
      <div class="stat-item">
        <div class="stat-num" id="updateStatus">‚ü≥</div>
        <div class="stat-label">Auto Update</div>
      </div>
      <div class="stat-item">
        <div class="stat-num">FREE</div>
        <div class="stat-label">100%</div>
      </div>
    </div>

    <p class="update-time">
      üïê Last Updated: <span id="lastUpdate">Loading...</span> (IST) | 
      <span class="live">‚óè Live</span>
    </p>

    <div class="cv-section">
      <div class="cv-title">üìÑ Your Info (Saved Locally)</div>
      <input type="text" class="cv-input" id="userName" placeholder="Your Full Name">
      <input type="text" class="cv-input" id="userPhone" placeholder="Phone (+91 XXXXX XXXXX)">
      <input type="text" class="cv-input" id="userEmail" placeholder="Your Email">
      <input type="text" class="cv-input" id="cvLink" placeholder="Google Drive CV Link (optional)">
      <p class="cv-status">‚úì Saved automatically when you apply</p>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">üìã Latest Jobs in Agartala</div>
        <button class="refresh-btn" id="refreshBtn" onclick="refreshJobs()">üîÑ Refresh</button>
      </div>
      <div class="job-grid" id="jobsList">
        <div class="loading"><span class="spin">‚ü≥</span> Loading jobs...</div>
      </div>
    </div>

    <div class="footer">
      <p>JobBot Pro ¬© 2025 | Auto-Update Active</p>
      <p style="margin-top:5px;">‚úÖ JSearch API | ‚úÖ Real-time Updates | ‚úÖ 100% Free</p>
    </div>
  </div>

  <!-- Apply Modal -->
  <div class="modal" id="applyModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>üìß Apply for Job</h3>
        <button class="close-btn" onclick="closeModal('applyModal')">&times;</button>
      </div>
      <div class="form-group">
        <label class="form-label">Position:</label>
        <input type="text" class="form-input" id="modalPosition" readonly>
      </div>
      <div class="form-group">
        <label class="form-label">Company:</label>
        <input type="text" class="form-input" id="modalCompany" readonly>
      </div>
      <div class="form-group">
        <label class="form-label">Your Cover Letter:</label>
        <textarea class="form-input form-textarea" id="modalCoverLetter"></textarea>
      </div>
      <button class="btn btn-apply" style="width:100%; padding:15px; font-size:14px;" onclick="sendApplication()">
        üì§ Open Email & Send Application
      </button>
    </div>
  </div>

  <!-- Details Modal -->
  <div class="modal" id="detailsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="detailTitle">Job Details</h3>
        <button class="close-btn" onclick="closeModal('detailsModal')">&times;</button>
      </div>
      <div class="desc-modal" id="detailContent"></div>
      <button class="btn btn-apply" style="margin-top:20px;" onclick="closeModal('detailsModal'); openApplyModal(currentDetailJob);">üìß Apply Now</button>
    </div>
  </div>

  <script>
    const RAPIDAPI_KEY = 'c50d199070mshd1ec6fc4eb809a6p106fbcjsn03dc25c06455';
    const CACHE_KEY = 'jobbot_jobs_cache';
    const CACHE_TIME_KEY = 'jobbot_cache_time';
    const ONE_HOUR = 60 * 60 * 1000;
    let currentJob = null;
    let currentDetailJob = null;

    // Load saved user info
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('userName').value = localStorage.getItem('userName') || '';
      document.getElementById('userPhone').value = localStorage.getItem('userPhone') || '';
      document.getElementById('userEmail').value = localStorage.getItem('userEmail') || '';
      document.getElementById('cvLink').value = localStorage.getItem('cvLink') || '';
      
      loadJobs();
      
      // Auto-refresh every hour
      setInterval(() => {
        const cacheTime = localStorage.getItem(CACHE_TIME_KEY);
        if (!cacheTime || Date.now() - parseInt(cacheTime) > ONE_HOUR) {
          refreshJobs();
        }
      }, 60000); // Check every minute
    });

    async function loadJobs() {
      const cacheTime = localStorage.getItem(CACHE_TIME_KEY);
      const cachedJobs = localStorage.getItem(CACHE_KEY);
      
      // Use cache if less than 1 hour old
      if (cachedJobs && cacheTime && Date.now() - parseInt(cacheTime) < ONE_HOUR) {
        const jobs = JSON.parse(cachedJobs);
        displayJobs(jobs);
        document.getElementById('lastUpdate').textContent = new Date(parseInt(cacheTime)).toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' });
        document.getElementById('updateStatus').textContent = '‚úì';
        return;
      }
      
      // Fetch new jobs
      await refreshJobs();
    }

    async function refreshJobs() {
      const btn = document.getElementById('refreshBtn');
      btn.disabled = true;
      btn.innerHTML = '<span class="spin">‚ü≥</span> Loading...';
      document.getElementById('updateStatus').textContent = '‚ü≥';
      
      try {
        const response = await fetch('https://jsearch.p.rapidapi.com/search?query=back%20office%20jobs%20in%20Agartala%20Tripura%20India&num_pages=1', {
          headers: {
            'X-RapidAPI-Key': RAPIDAPI_KEY,
            'X-RapidAPI-Host': 'jsearch.p.rapidapi.com'
          }
        });
        
        const data = await response.json();
        const jobs = data.data || [];
        
        // Process jobs
        const processedJobs = jobs.map(job => ({
          id: job.job_id || Math.random().toString(36).substr(2, 9),
          title: job.job_title || 'Unknown Position',
          company: job.employer_name || 'Unknown Company',
          location: job.job_city ? `${job.job_city}, ${job.job_country || 'India'}` : 'Agartala, Tripura',
          salary: job.job_salary || 'Salary not specified',
          type: getJobType(job.job_title || '', job.employer_name || ''),
          description: job.job_description || 'No description available',
          email: job.employer_email || null,
          applyLink: job.job_apply_link || null,
          match: calculateMatch(job.job_title || ''),
          posted: job.job_posted_at || 'Recently'
        }));
        
        // Add some fallback jobs if API returns few results
        if (processedJobs.length < 5) {
          processedJobs.push(...getFallbackJobs());
        }
        
        // Cache jobs
        localStorage.setItem(CACHE_KEY, JSON.stringify(processedJobs));
        localStorage.setItem(CACHE_TIME_KEY, Date.now().toString());
        
        displayJobs(processedJobs);
        document.getElementById('lastUpdate').textContent = new Date().toLocaleString('en-IN', { timeZone: 'Asia/Kolkata' });
        document.getElementById('updateStatus').textContent = '‚úì';
        
      } catch (error) {
        console.error('Error fetching jobs:', error);
        
        // Use fallback jobs on error
        const fallbackJobs = getFallbackJobs();
        displayJobs(fallbackJobs);
        document.getElementById('lastUpdate').textContent = 'Using cached data';
        document.getElementById('updateStatus').textContent = '‚ö†';
      }
      
      btn.disabled = false;
      btn.innerHTML = 'üîÑ Refresh';
    }

    function getFallbackJobs() {
      return [
        { id: 'f1', title: 'Back Office Executive', company: 'Tripura State Co-operative Bank', location: 'Agartala, Tripura', salary: '‚Çπ18,000 - ‚Çπ25,000', type: 'bank', description: 'Handle data entry, document management, and administrative tasks.', email: 'hr@tscb.co.in', match: 95 },
        { id: 'f2', title: 'Data Entry Operator', company: 'Tripura Government Press', location: 'Agartala, Tripura', salary: '‚Çπ15,000 - ‚Çπ20,000', type: 'government', description: 'Government job for data entry with typing speed 30+ WPM required.', email: 'recruitment@tripura.gov.in', match: 92 },
        { id: 'f3', title: 'Office Assistant', company: 'Tribal Welfare Department', location: 'Agartala, Tripura', salary: '‚Çπ16,000 - ‚Çπ22,000', type: 'government', description: 'Office assistant for filing, record keeping. Bengali/Kokborok preferred.', email: 'twd@tripura.gov.in', match: 88 },
        { id: 'f4', title: 'Clerk cum Computer Operator', company: 'District Court Agartala', location: 'Agartala, Tripura', salary: '‚Çπ19,000 - ‚Çπ25,000', type: 'government', description: 'Clerk position with computer skills and typing in English/Bengali.', email: 'court@tripura.gov.in', match: 85 },
        { id: 'f5', title: 'Administrative Assistant', company: 'ICICI Bank Agartala', location: 'Agartala, Tripura', salary: '‚Çπ20,000 - ‚Çπ28,000', type: 'bank', description: 'Bank back office for documentation and customer forms.', email: 'careers@icicibank.com', match: 82 },
        { id: 'f6', title: 'Backend Support Executive', company: 'BSNL Agartala', location: 'Agartala, Tripura', salary: '‚Çπ22,000 - ‚Çπ30,000', type: 'government', description: 'Backend support for telecom operations and billing.', email: 'recruitment@bsnl.co.in', match: 80 },
        { id: 'f7', title: 'Computer Operator', company: 'SBI Agartala Branch', location: 'Agartala, Tripura', salary: '‚Çπ18,000 - ‚Çπ22,000', type: 'bank', description: 'Computer operator for data entry and document scanning.', email: 'recruitment@sbi.co.in', match: 75 },
        { id: 'f8', title: 'Office Clerk', company: 'Tripura University', location: 'Agartala, Tripura', salary: '‚Çπ16,000 - ‚Çπ21,000', type: 'government', description: 'Clerk for administrative tasks and student records.', email: 'recruitment@tripurauniv.ac.in', match: 70 }
      ];
    }

    function getJobType(title, company) {
      const lowerTitle = title.toLowerCase();
      const lowerCompany = company.toLowerCase();
      if (lowerCompany.includes('bank') || lowerTitle.includes('bank')) return 'bank';
      if (lowerCompany.includes('government') || lowerCompany.includes('court') || lowerCompany.includes('university') || lowerCompany.includes('municipal') || lowerCompany.includes('bsnl')) return 'government';
      return 'private';
    }

    function calculateMatch(title) {
      const keywords = ['back office', 'data entry', 'clerk', 'assistant', 'computer operator', 'office'];
      let score = 70;
      keywords.forEach(kw => { if (title.toLowerCase().includes(kw)) score += 4; });
      return Math.min(score, 95);
    }

    function displayJobs(jobs) {
      const container = document.getElementById('jobsList');
      document.getElementById('jobCount').textContent = jobs.length;
      
      if (jobs.length === 0) {
        container.innerHTML = '<div class="no-jobs"><p>üîç No jobs found. Try refreshing.</p></div>';
        return;
      }
      
      container.innerHTML = jobs.map(job => `
        <div class="job-card ${job.type}">
          <div class="job-header">
            <div>
              <div class="job-title">${job.title}</div>
              <div class="job-company">${job.company}</div>
            </div>
            <div class="job-salary">${job.salary}</div>
          </div>
          <div class="job-details">
            <span>üìç ${job.location}</span>
            <span class="job-type type-${job.type}">${job.type === 'government' ? 'üèõÔ∏è Govt' : job.type === 'bank' ? 'üè¶ Bank' : 'üè¢ Private'}</span>
          </div>
          <div class="match-badge">${job.match}% Match</div>
          <br>
          <button class="btn btn-apply" onclick='openApplyModal(${JSON.stringify(job).replace(/'/g, "\\'")})'>üìß Apply</button>
          <button class="btn btn-details" onclick='openDetailsModal(${JSON.stringify(job).replace(/'/g, "\\'")})'>üëÅÔ∏è Details</button>
        </div>
      `).join('');
    }

    function openApplyModal(job) {
      currentJob = job;
      
      const name = document.getElementById('userName').value || '[Your Name]';
      const phone = document.getElementById('userPhone').value || '[Phone]';
      const email = document.getElementById('userEmail').value || '[Email]';
      const cvLink = document.getElementById('cvLink').value;
      
      // Save user info
      localStorage.setItem('userName', name);
      localStorage.setItem('userPhone', phone);
      localStorage.setItem('userEmail', email);
      localStorage.setItem('cvLink', cvLink);
      
      const coverLetter = `Dear Hiring Manager,

I am writing to apply for the ${job.title} position at ${job.company}.

I have relevant skills and experience that make me a strong candidate:
‚úì MS Office (Word, Excel, PowerPoint)
‚úì Data Entry & Documentation
‚úì Communication in Bengali, Hindi & English
‚úì Computer Operations

I am available for interview at your convenience.

 ${cvLink ? `üìÑ My CV: ${cvLink}` : ''}

Best regards,
 ${name}
üìû ${phone}
üìß ${email}`;

      document.getElementById('modalPosition').value = job.title;
      document.getElementById('modalCompany').value = job.company;
      document.getElementById('modalCoverLetter').value = coverLetter;
      document.getElementById('applyModal').style.display = 'block';
    }

    function sendApplication() {
      if (!currentJob) return;
      
      const subject = encodeURIComponent(`Application for ${currentJob.title} - ${document.getElementById('userName').value}`);
      const body = encodeURIComponent(document.getElementById('modalCoverLetter').value);
      
      const email = currentJob.email || 'careers@example.com';
      window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
      
      closeModal('applyModal');
      setTimeout(() => alert('‚úÖ Email opened! Tap Send to submit your application.'), 500);
    }

    function openDetailsModal(job) {
      currentDetailJob = job;
      document.getElementById('detailTitle').textContent = job.title;
      document.getElementById('detailContent').innerHTML = `
        <p style="color:#60a5fa; margin-bottom:15px;">${job.company}</p>
        <p style="margin-bottom:10px;"><strong>üìç Location:</strong> ${job.location}</p>
        <p style="margin-bottom:10px;"><strong>üí∞ Salary:</strong> ${job.salary}</p>
        <p style="margin-bottom:10px;"><strong>üìù Description:</strong></p>
        <p style="color:#94a3b8; margin-bottom:15px;">${job.description}</p>
        <p><strong>Match Score:</strong> <span style="color:#22c55e;">${job.match}%</span></p>
      `;
      document.getElementById('detailsModal').style.display = 'block';
    }

    function closeModal(id) {
      document.getElementById(id).style.display = 'none';
    }

    // Close modal on outside click
    window.onclick = (e) => { if (e.target.classList.contains('modal')) e.target.style.display = 'none'; };
  </script>
</body>
</html>
